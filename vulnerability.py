import pandas as pd
import os
import numpy as np
import src.samplingFuncs as sm
import src.vulnerabilityFuncs as vf

#Initialise repositories
_projroot = os.path.abspath('.')
_datadir = os.path.join(_projroot, 'data')
_preprocesseddir = os.path.join(_datadir, 'preprocesseddata')
_experimentdir = os.path.join(_datadir, 'experiments')
_rawdir = os.path.join(_datadir, 'rawdata')
_src = os.path.join(_projroot,'src')
_sampling = os.path.join(_experimentdir,'sampling')

vulnerability = os.path.join(_experimentdir,'vulnerability')
undersampling = os.path.join(_sampling,'undersampling')

WCC_total = vf.Vulnerability()
WCC_total.read_file(undersampling, 'undersampling', sheetname = ['original' ,'Training_Data', 'Near Miss - Ratio 0.7'])
WCC_total.elastic_regression()
WCC_total.save_coefficients(vulnerability, 'test')
WCC_total.find_variance()
WCC_total.plot_feature('AGE', 'Probability of Digital Exclusion According to Age', 'Age', os.path.join(vulnerability,'Age.png'))
WCC_total.plot_feature('AcornTypeCode', 'Probability of Digital Exclusion According to Acorn Type', 'Acorn Type Code', os.path.join(vulnerability,'Acorn.png'))
WCC_total.plot_feature('Number of Council Services accessed', 'Probability of Digital Exclusion According to Council Services Accessed', 'Number of Council Services Accessed', os.path.join(vulnerability,'Retirement.png'))
